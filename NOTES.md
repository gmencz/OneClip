[] Cleanup and better error handling
